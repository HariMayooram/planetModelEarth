import {
  ChatOpenAI
} from "./chunk-5TRACQTY.js";
import "./chunk-SM6WFYUK.js";
import "./chunk-XQVUGUOI.js";
import "./chunk-BSQLF4IC.js";
import "./chunk-OGEBVHA4.js";
import "./chunk-VM2NCINP.js";
import "./chunk-SZ5YZSBG.js";
import "./chunk-JP7NZRAT.js";
import "./chunk-BBKWHEB7.js";
import "./chunk-K33DWHXQ.js";
import "./chunk-ICLFDNLI.js";
import "./chunk-JOAYDMNN.js";
import "./chunk-M3ACBAEH.js";
import "./chunk-LR3466M7.js";
import {
  getEnvironmentVariable
} from "./chunk-ZU4UXHAA.js";
import "./chunk-EWTE5DHJ.js";

// node_modules/@langchain/xai/dist/chat_models.js
var ChatXAI = class extends ChatOpenAI {
  static lc_name() {
    return "ChatXAI";
  }
  _llmType() {
    return "xAI";
  }
  get lc_secrets() {
    return {
      apiKey: "XAI_API_KEY"
    };
  }
  constructor(fields) {
    const apiKey = (fields == null ? void 0 : fields.apiKey) || getEnvironmentVariable("XAI_API_KEY");
    if (!apiKey) {
      throw new Error(`xAI API key not found. Please set the XAI_API_KEY environment variable or provide the key into "apiKey" field.`);
    }
    super({
      ...fields,
      model: (fields == null ? void 0 : fields.model) || "grok-beta",
      apiKey,
      configuration: {
        baseURL: "https://api.x.ai/v1"
      }
    });
    Object.defineProperty(this, "lc_serializable", {
      enumerable: true,
      configurable: true,
      writable: true,
      value: true
    });
    Object.defineProperty(this, "lc_namespace", {
      enumerable: true,
      configurable: true,
      writable: true,
      value: ["langchain", "chat_models", "xai"]
    });
  }
  toJSON() {
    const result = super.toJSON();
    if ("kwargs" in result && typeof result.kwargs === "object" && result.kwargs != null) {
      delete result.kwargs.openai_api_key;
      delete result.kwargs.configuration;
    }
    return result;
  }
  getLsParams(options) {
    const params = super.getLsParams(options);
    params.ls_provider = "xai";
    return params;
  }
  /**
   * Calls the xAI API with retry logic in case of failures.
   * @param request The request to send to the xAI API.
   * @param options Optional configuration for the API call.
   * @returns The response from the xAI API.
   */
  async completionWithRetry(request, options) {
    delete request.frequency_penalty;
    delete request.presence_penalty;
    delete request.logit_bias;
    delete request.functions;
    const newRequestMessages = request.messages.map((msg) => {
      if (!msg.content) {
        return {
          ...msg,
          content: ""
        };
      }
      return msg;
    });
    const newRequest = {
      ...request,
      messages: newRequestMessages
    };
    if (newRequest.stream === true) {
      return super.completionWithRetry(newRequest, options);
    }
    return super.completionWithRetry(newRequest, options);
  }
};
export {
  ChatXAI
};
//# sourceMappingURL=@langchain_xai.js.map
